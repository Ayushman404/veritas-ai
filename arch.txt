================================================================================
                    VERITAS SYSTEM ARCHITECTURE v3.0
               (Hybrid RAG + Multi-Modal Ingestion)
================================================================================

[ USER (React UI) ]
      |
      |  (Direct HTTP / CORS Enabled)
      v
+------------------------------------------------------------------------------+
|                           AI ENGINE (Python/FastAPI)                         |
|                                                                              |
|  +--- FLOW A: MULTI-MODAL INGESTION (The Learning Phase) -----------------+  |
|  |                                                                        |  |
|  |   [Source A: PDF Files]            [Source B: Web URLs]                |  |
|  |   (Research Papers/Docs)           (News/Wikipedia)                    |  |
|  |             |                                |                         |  |
|  |             v                                v                         |  |
|  |      [PyPDFLoader]                    [WebBaseLoader]                  |  |
|  |             |                                |                         |  |
|  |             +------------+-------------------+                         |  |
|  |                          |                                             |  |
|  |                          v                                             |  |
|  |                  [TEXT CLEANER]                                        |  |
|  |    (Removes citations [1], extra whitespace, headers)                  |  |
|  |                          |                                             |  |
|  |                          v                                             |  |
|  |           [RecursiveCharacterTextSplitter]                             |  |
|  |       (Chunk Size: 1000 | Overlap: 200 tokens)                         |  |
|  |                          |                                             |  |
|  |                          v                                             |  |
|  |               [EMBEDDING MODEL]                                        |  |
|  |   (HuggingFace: all-MiniLM-L6-v2 / Google Embeddings)                  |  |
|  |                          |                                             |  |
|  |           +--------------+---------------+                             |  |
|  |           |                              |                             |  |
|  |           v                              v                             |  |
|  |    [BM25 Index]                     [ChromaDB]                         |  |
|  | (Sparse / Keyword Map)        (Dense / Vector Store)                   |  |
|  |   "Exact Matches"                "Semantic Concepts"                   |  |
|  +------------------------------------------------------------------------+  |
|                                                                              |
|                                                                              |
|  +--- FLOW B: INFERENCE PIPELINE (The Thinking Phase) --------------------+  |
|  |                                                                        |  |
|  |  1. [User Query]                                                       |  |
|  |          |                                                             |  |
|  |          v                                                             |  |
|  |  [QUERY REWRITER (Gemini 2.5 Flash)]                                   |  |
|  |  "What is the price?" -> "What is the price of Apple stock?"           |  |
|  |          |                                                             |  |
|  |          +-------------+-----------------------+                       |  |
|  |                        |                       |                       |  |
|  |                        v                       v                       |  |
|  |                  [Vector Search]         [BM25 Search]                 |  |
|  |                  (Finds Context)        (Finds Keywords)               |  |
|  |                        |                       |                       |  |
|  |                        +-----------+-----------+                       |  |
|  |                                    |                                   |  |
|  |                            [ENSEMBLE MERGE]                            |  |
|  |                     (Deduplicate & Weight 50/50)                       |  |
|  |                                    |                                   |  |
|  |                                    v                                   |  |
|  |                          [TOP K DOCUMENT CHUNKS]                       |  |
|  |                                    |                                   |  |
|  |                                    v                                   |  |
|  |                          [GENERATOR PROMPT]                            |  |
|  |             "Answer based ONLY on this context..."                     |  |
|  |                                    |                                   |  |
|  |                                    v                                   |  |
|  |                          [GEMINI 2.5 FLASH]                            |  |
|  |                                    |                                   |  |
|  |                                    v                                   |  |
|  |                           [FINAL ANSWER]                               |  |
|  +------------------------------------------------------------------------+  |
|                                                                              |
+------------------------------------------------------------------------------+